<!DOCTYPE html>
<html lang="en">
	<head>
        <meta charset="UTF-8">
	    <title>Team Charts</title>
	    <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.2/underscore.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.12.1/react-with-addons.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.12.1/JSXTransformer.js"></script>
	    <script src="https://code.jquery.com/jquery-1.10.0.min.js"></script>
	    <script src="https://cdn.rawgit.com/esbullington/react-d3/fff663d549c9492ecf7da3a4108718b04630432a/dist/public/js/react-d3.min.js"></script>

        <link rel="stylesheet/less" type="text/css" href="styles/main.less">
        <link href="//elements.storebrand.no/storebrand.ny/0.50/css/stb-main.css" type="text/css" rel="stylesheet"/>
    </head>
    <body>
		<!-- containers -->
		<div id="example"></div>
        <div class="wrapper">
            <div class="flex-parent flex-column">
                <div class="flex-item" id="chart1">
                </div>
                <div class="flex-item flex-parent">
                    <div class="flex-item">
                        Content here
                    </div>
                    <div class="flex-item weight-2">
                        Content here
                    </div>
                </div>
            </div>
        </div>

        <script type="text/jsx">
            var LineChart = rd3.LineChart;

			var LineChartComponent = React.createClass({

                loadChartDataFromServer: function() {
                    $.ajax({
                        url: this.props.url,
                        dataType: 'json',
                        success: function(data) {
                            //this.setState({lineChartData: data});
                            console.log(data);
                        }.bind(this),
                        error: function(xhr, status, err) {
                            console.error(this.props.url, status, err.toString());
                        }.bind(this)
                    });
                },

                componentDidMount: function(){
                    this.loadChartDataFromServer();
                    setInterval(this.loadChartDataFromServer, this.props.pollInterval);
                },

                getInitialState:function(){
                    return {
                        lineChartData: [
                            {
                                name: 'series1',
                                values: [ { x: 0, y: 20 }, { x: 1, y: 30 }, { x: 2, y: 10 }, { x: 3, y: 5 }, { x: 4, y: 8 }, { x: 5, y: 15 }, { x: 6, y: 10 } ]
                            },
                            {
                                name: 'series2',
                                values : [ { x: 0, y: 8 }, { x: 1, y: 5 }, { x: 2, y: 20 }, { x: 3, y: 12 }, { x: 4, y: 4 }, { x: 5, y: 6 }, { x: 6, y: 2 } ]
                            },
                            {
                                name: 'series3',
                                values: [ { x: 0, y: 0 }, { x: 1, y: 5 }, { x: 2, y: 8 }, { x: 3, y: 2 }, { x: 4, y: 6 }, { x: 5, y: 4 }, { x: 6, y: 2 } ]
                            }
                        ],
                        width: 500,
                        height: 300
                    }
                },

			    render: function() {
			        return (
                            <LineChart
                                    legend={true}
                                    data={this.state.lineChartData}
                                    width={this.state.width}
                                    height={this.state.height}
                                    title="Hits Per Day"
                            />
			            );
			    }
			});
			 
			React.render(<LineChartComponent url="http://date.jsontest.com" pollInterval={5000} />, document.getElementById('chart1'));
		</script>

        <script type="text/jsx">
      		var App = React.createClass({

      			loadChartDataFromServer: function() {
				    $.ajax({
				      url: this.props.url,
				      dataType: 'json',
				      success: function(data) {
				        this.setState({data: data});
				      }.bind(this),
				      error: function(xhr, status, err) {
				        console.error(this.props.url, status, err.toString());
				      }.bind(this)
				    });
				},

      			componentDidMount: function(){
      				this.loadChartDataFromServer();
      				setInterval(this.loadChartDataFromServer, this.props.pollInterval);
   				},	

      			getInitialState:function(){
				    return {
				      query: '',
				      data: {},
				      id: 0
				    }
				},

				getDefaultProps:function(){
			    	return {
			      		txt: 'this is a default prop',
			      		cat: 0
			    	}
			  	},

			  	update: function(e){
					this.setState({query: e.target.value});
				},

      			propTypes: {
      				txt: React.PropTypes.string,
      				cat: React.PropTypes.number.isRequired
      			},
      			render: function() {
      				return (
      					<div>
      						<input type="text" onChange={this.update} />
      						<br/>
      						<span>{this.props.txt} {this.props.cat}</span>
        					<h1>Hello, world!</h1>
        					<span>{this.state.query}</span>
        				</div>
        			)	
      			}	
      		});

      		React.render(<App txt="this is the props" url="http://date.jsontest.com" pollInterval={5000} />, document.getElementById('example'));
    </script>
    <script src="js/less.min.js" type="text/javascript"></script>
  </body>
</html>
